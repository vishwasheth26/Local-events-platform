<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Events â€” Evinza</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .events-grid { display:grid; gap:1rem; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
    .card img { width:100%; height:140px; object-fit:cover; border-radius:8px; }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo"><div class="logo-icon">ðŸ‘¥</div><span>Evinza</span></a>
      <div class="nav-links">
        <a href="events.html" class="nav-link">Events</a>
        <a href="create-event.html" class="btn btn-outline">+ Create Event</a>
      </div>
    </div>
  </nav>

  <main class="container" style="margin-top:2rem;">
    <h1>My Events</h1>
    <p class="muted">Events you created in this browser (local only).</p>

    <div id="myEventsGrid" class="events-grid" style="margin-top:1rem;"></div>
  </main>

  <script src="mock-data.js"></script>
  <script>
    function loadMyEvents() {
      return JSON.parse(localStorage.getItem('customEvents') || '[]');
    }

    function render() {
      const list = loadMyEvents();
      const grid = document.getElementById('myEventsGrid');
      if (list.length === 0) {
        grid.innerHTML = '<p class="muted">You have not created any events yet.</p>';
        return;
      }

      grid.innerHTML = list.map(ev => `
        <div class="card" style="padding:1rem;">
          <img src="${ev.image}" alt="">
          <h3 style="margin:0.5rem 0;">${ev.title}</h3>
          <p class="muted">${new Date(ev.date).toLocaleDateString()} â€¢ ${ev.time || 'â€”'}</p>
          <div style="display:flex; gap:.5rem; margin-top:.75rem;">
            <a class="btn btn-primary" href="event-detail.html?id=${ev.id}">View</a>
            <a class="btn btn-outline" href="edit-event.html?id=${ev.id}">Edit</a>
            <button class="btn btn-outline" onclick="deleteEvent(${ev.id})" style="background:#fee2e2; color:#991b1b;">Delete</button>
          </div>
        </div>
      `).join('');
    }

  let pendingDeleteId = null;

function deleteEvent(id) {
    pendingDeleteId = id;

    showSnackbar(
        "Delete this event?",
        [
            { label: "Cancel", onclick: "cancelDelete()" },
            { label: "Delete", onclick: "confirmDeleteMyEvent()" }
        ]
    );
}

function cancelDelete() {
    pendingDeleteId = null;
    document.getElementById("snackbar").classList.remove("show");
}

function confirmDeleteMyEvent() {
    if (!pendingDeleteId) return;

    let arr = JSON.parse(localStorage.getItem('customEvents') || '[]');
    arr = arr.filter(e => Number(e.id) !== Number(pendingDeleteId));
    localStorage.setItem('customEvents', JSON.stringify(arr));

    pendingDeleteId = null;
    cancelDelete();
    render();
}


    render();
    // Auto-refresh when other tab updates events
window.addEventListener("storage", (e) => {
    if (e.key === "customEvents" || e.key === "attendingEvents") {
        location.reload();
    }
});

  </script>
  <div id="snackbar" class="snackbar"></div>

</body>
</html>
